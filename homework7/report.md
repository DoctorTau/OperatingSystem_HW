# Отчет по лабораторной работе №7

## Задание

Разработать программы клиента и сервера, взаимодействующих через
разделяемую память с использованием функций `POSIX`. Клиент
генерирует случайные числа в том же диапазоне, что и ранее рассмотренный
 на семинаре пример. Сервер осуществляет их вывод.

## Решение

Файлы:

* [server.c](server.c) - серверная программа
* [client.c](client.c) - клиентская программа
* [message.h](message.h) - заголовочный файл с определением структуры сообщения и его типов

## Отчет

Серверная программа открывает объект `shared memory` с помощью функции `shm_open()`, создавая при этом объект `shared memory` и возвращая его дескриптор. Если объект уже открыт, программа выводит сообщение об ошибке и завершается. Затем программа устанавливает размер общей памяти с помощью функции `ftruncate()` и получает указатель на эту память с помощью функции `mmap()`. После этого программа переходит в бесконечный цикл для чтения и обработки сообщений. Если получено новое сообщение, программа проверяет тип сообщения и выводит содержимое сообщения в случае, если это сообщение типа `MSG_TYPE_STRING`, или завершает свою работу, если это сообщение типа `MSG_TYPE_FINISH`. После обработки сообщения программа устанавливает тип сообщения в `MSG_TYPE_EMPTY`.

Клиентская программа также открывает объект `shared memory` и получает указатель на эту память с помощью функции `mmap()`. Затем программа отправляет заданное с помощью аргументов командной строки, количество случайно сгенерированных сообщений в объект shared memory. После отправки всех сообщений программа отправляет сообщение типа `MSG_TYPE_FINISH` для завершения работы.

Оба модуля используют файл `message.h` для определения структуры сообщения и его типов.
